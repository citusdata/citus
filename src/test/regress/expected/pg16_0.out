--
-- PG16
--
SHOW server_version \gset
SELECT substring(:'server_version', '\d+')::int >= 16 AS server_version_ge_16
\gset
-- test invalid statistics
-- behavior is same among PG versions, error message differs
-- relevant PG16 commits: d84a6c3dad1 and f30c04682cd
CREATE STATISTICS tst ON a FROM (VALUES (x)) AS foo;
ERROR:  only a single relation is allowed in CREATE STATISTICS
CREATE FUNCTION tftest(int) returns table(a int, b int) as $$
SELECT $1, $1+i FROM generate_series(1,5) g(i);
$$ LANGUAGE sql IMMUTABLE STRICT;
CREATE STATISTICS alt_stat2 ON a FROM tftest(1);
ERROR:  only a single relation is allowed in CREATE STATISTICS
DROP FUNCTION tftest;
\if :server_version_ge_16
\else
\q
